---
layout: default
---

<div class="paper-container">
  <h1>{{ page.title }}</h1>
  <p><strong>Authors:</strong> {{ page.authors | join: ", " }}</p>
  <p><strong>PDF:</strong> <a href="{{ page.pdf }}" target="_blank">Download</a></p>
  <p>{{ page.abstract }}</p>

  <hr>
  <h2>Full Abstract</h2>
  <div class="paper-body">
    {{ content }}
  </div>

  <hr>

  <h2>Ask anything about this paper</h2>

  <div id="chat-box" style="
    border: 1px solid #aaa;
    border-radius: 8px;
    padding: 15px;
    max-width: 700px;
    background: #fafafa;">
    
    <div id="chat-log" style="min-height:120px; margin-bottom:10px;"></div>

    <input id="chat-input"
      type="text"
      placeholder="Ask a question about this paper..."
      style="width: 100%; padding: 10px; border-radius: 6px;">
  </div>
</div>

<script>
document.getElementById("chat-input").addEventListener("keypress", function(e) {
    if (e.key === "Enter") {
        const question = this.value.trim();
        if (!question) return;

        const chatLog = document.getElementById("chat-log");
        chatLog.innerHTML += "<p><strong>You:</strong> " + question + "</p>";

        this.value = "";

        // Send to OpenAI API (requires userâ€™s API key stored separately)
        fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + localStorage.getItem("user_api_key")
            },
            body: JSON.stringify({
                model: "gpt-4o-mini",
                messages: [
                  { role: "system", content: "You answer ONLY using the content of this research paper: {{ page.abstract | escape }} {{ content | escape }}" },
                  { role: "user", content: question }
                ]
            })
        })
        .then(res => res.json())
        .then(data => {
            const answer = data.choices?.[0]?.message?.content || "Error";
            chatLog.innerHTML += "<p><strong>Bot:</strong> " + answer + "</p>";
        })
    }
});
</script>
